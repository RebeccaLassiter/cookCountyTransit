<!DOCTYPE html>
<html>

<head>
  <title>Cook County Transit</title>
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://d3js.org/colorbrewer.v1.min.js"></script>
  <link rel="stylesheet" href="/src/build/styles.css">
<!--    <link rel="stylesheet" type="text/css" href="languagesMap.css"> -->
</head>

<body>
	<div id="idyll-mount"><div data-reactroot=""><div class="idyll-root"><div style="max-width:600px;margin:0 0 0 50px" class=" idyll-text-container"><h1>Commuting Habits in Cook County</h1><p>Mobility and transportation is an issue that impacts almost everyone, yet is not present in the public consciousness. Access to transportation is essential in order to maintain a job, sustain a social life, and fulfill basic human needs. In urban areas like Cook County, the issue of mobility becomes more complex when accounting for the high density of people that need to travel over large geographic areas. Most individuals move around using either cars or public transit. Owning a car can be cost prohibitive, especially in an area as expensive as Cook County. One of the best ways to ensure that all people can easily move throughout Chicagoland is by supporting and funding public transit systems. </p>
	<p>Compared to the rest of the United States, Cook county has a very extensive public transit network, yet there is still great room for improvement. In particular, existing inequities regarding race and class can intersect and impact an individualâ€™s access to affordable and efficient transportation. We can examine the areas that are best served by public transit, and those that are least served--while taking into account the demographics of these areas. </p>
	<p>Select different tracts below to view more details!</p>
	<h2> Census Tracts Characterized by Public Transit</h2>
</div></div></div></div>
  <div style="margin:0 0 50px 50px" id="holder">
	  <div id="scatterLegend"></div>
	  <div id="scatterPlot"></div>

	  <div id="tractData"></div>

    </div>

  <script>
  	console.log("scatterplot")
  	// set the dimensions and margins of the graph
	var margin = {top: 10, right: 30, bottom: 30, left: 60},
	    width = 460 - margin.left - margin.right,
	    height = 400 - margin.top - margin.bottom;

	

	// append the svg object to the body of the page
	var svg = d3.select("#scatterPlot")
	  .append("svg")
	    .attr("width", 600)//width + margin.left + margin.right)
	    .attr("height", height + margin.top + margin.bottom)
	  .append("g")
	    .attr("transform",
	          "translate(" + margin.left + "," + margin.top + ")");

	//loading data and making scatter plot
	d3.csv("scatterPlotData.csv", function(data){
		// Add X axis
		var x = d3.scaleLinear()
			.domain([0, d3.max(data, function(d){return d.meanTravelTimeTransit})])
		    .range([ 0, width ]);
		svg.append("g")
		    .attr("transform", "translate(0," + height + ")")
		    .call(d3.axisBottom(x));

		// Add Y axis
		var y = d3.scaleLinear()
		    .domain([0, d3.max(data, function(d){return d.commuttersTakingTransit/d.totalPeople})])
		    .range([ height, 0]);
		svg.append("g")
		    .call(d3.axisLeft(y));

		var color = d3.scaleLinear()
      		.range(["white", "green"]) 
  			.domain([0, d3.max(data, function(d){return d.medianIncome})])

		  // Add dots
		svg.append('g')
		    .selectAll("dot")
		    .data(data)
		    .enter()
		    .append("circle")
		    	.attr("cx", function (d) { return x(d.meanTravelTimeTransit); } )
		    	//percent of people taking transit
		    	.attr("cy", function (d) { return y(d.commuttersTakingTransit/d.totalPeople); } ) 
		    	.attr("r", 3)
		    	.style("fill", function(d){return color(d.medianIncome)})//"#69b3a2")
		    	.on("mouseover", function(d, i){
		    						console.log(d.medianIncome)
		    						console.log("color:", color(d.medianIncome))
		    						d3.select(this).transition()
					                	.duration('70')
					                	.attr("r", 6);})
		    	.on('mouseout', function (d, i) {
							        d3.select(this).transition()
							        	.duration('70')
							        	.attr("r", 3);})
		    	.on("click", function(d, i) {createTractData(d)})
		//add axis labels
		svg.append("text")             
		      .attr("transform",
		            "translate(" + (width/2) + " ," + 
		                           (height + margin.top + 20) + ")")
		      .style("text-anchor", "middle")
		      .text("Mean Travel Time on Transit");
		svg.append("text")
		    .attr("transform", "rotate(-90)")
		    .attr("y", 0 - margin.left)
		    .attr("x",0 - (height / 2))
		    .attr("dy", "1em")
		    .style("text-anchor", "middle")
		    .text("Percent of People Taking Transit"); 

		//scatter plot legend
		//legend
	    var domain = color.domain()[1]
	    var legendIntervals = [0, domain*.2, domain*.4, domain*.6, domain*.8, domain]
	    var extent = d3.extent(legendIntervals, d => d);

	      var defs = svg.append("defs");
	      var linearGradient = defs.append("linearGradient").attr("id", "myGradient");
	      linearGradient.selectAll("stop")
	          .data(legendIntervals)
	        .enter().append("stop")
	          .attr("offset", d => ((d - extent[0]) / (extent[1] - extent[0]) * 100) + "%")
	          .attr("stop-color", d => color(d));

	      d3.select("g").append("rect")
	          .attr("width", 200)
	          .attr("height", 25)
	          .attr("x", 300)
	          .attr("y", 25)
	          .style("fill", "url(#myGradient)");

	      d3.select("g").append("text")
	          .attr("id", "labelLow")
	          .attr("x", 250)
	          .attr("y", 75)
	          .text('$4,345');
	      d3.select("g").append("text")
	          .attr("id","labelHigh")
	          .attr("x", 450)
	          .attr("y", 75)
	          .text("$157,500");
	     d3.select("g").append("text")
	          .attr("id","labelHigh")
	          .attr("x", 330)
	          .attr("y", 5)
	          .text("Median Income");
	})


	function createTractData(d){
		d3.selectAll("#tractData").remove();
		d3.select("#holder").append("div") //.select("#tractData");
		.attr("id", "tractData");

		d3.selectAll("#tractData").append("text")
		.text(d.niceName);

		d3.select("#tractData").append("text")
		.text("Median Income"+ d.medianIncome);
	}
	


  </script>
</body>

</html>